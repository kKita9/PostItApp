@page "/friends"
@using BlazorFrontend.Services

@inject FriendService FriendService

<h1>Friends</h1>
<NavLink class="nav-link" href="friends">
    <span class="oi oi-list-rich" aria-hidden="true"></span> Friends
</NavLink>

@if (friends == null)
{
    <p>Loading friends...</p>
}
else
{
    @foreach (var friend in friends)
    {
        <div>
            <p>Name: @friend.FirstName</p>
        </div>
    }
}

@code {
    private List<Models.FriendModel> friends;
    private bool isLoaded = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && !isLoaded)
        {
            friends = await FriendService.GetFriendsAsync();
            isLoaded = true; // Zapobiega ponownemu ładowaniu przy każdym renderowaniu
            StateHasChanged(); // Informuje Blazor, że należy ponownie wyrenderować komponent
        }
    }
}